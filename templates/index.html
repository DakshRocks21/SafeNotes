<!DOCTYPE html>
<html>
<head>
    <title>SafeNotes CRUD</title>
    <style>
        .note { border: 1px solid #ccc; padding: 10px; margin: 10px; }
        button { margin-left: 10px; }
    </style>
</head>
<body>
    <h1>SafeNotes</h1>

    <!-- Create Note Form -->
    <div>
        <h2>Create New Note</h2>
        <textarea id="newContent" rows="3"></textarea>
        <button onclick="createNote()">Create</button>
    </div>

    <!-- Notes Display -->
    <div id="notes"></div>

    <script>
        // Helper function for API calls
        async function fetchJson(url, options) {
            const response = await fetch(url, {
                headers: {
                    'Content-Type': 'application/json',
                },
                ...options
            });
            return await response.json();
        }

        // Create Note
        async function createNote() {
            const content = document.getElementById('newContent').value;
            await fetchJson('/notes', {
                method: 'POST',
                body: JSON.stringify({ content })
            });
            loadNotes();
        }

        // Update Note
        async function updateNote(id) {
            const content = prompt('Enter new content:');
            if (content) {
                await fetchJson(`/notes/${id}`, {
                    method: 'PUT',
                    body: JSON.stringify({ content })
                });
                loadNotes();
            }
        }

        // Delete Note
        async function deleteNote(id) {
            if (confirm('Are you sure?')) {
                await fetchJson(`/notes/${id}`, { method: 'DELETE' });
                loadNotes();
            }
        }

        // Load and Display Notes
        async function loadNotes() {
            const notes = await fetchJson('/notes');
            const container = document.getElementById('notes');
            container.innerHTML = '<h2>Your Notes</h2>';

            for (const [id, content] of Object.entries(notes)) {
                const noteDiv = document.createElement('div');
                noteDiv.className = 'note';
                noteDiv.innerHTML = `
                    <p>${content}</p>
                    <button onclick="updateNote('${id}')">Edit</button>
                    <button onclick="deleteNote('${id}')">Delete</button>
                `;
                container.appendChild(noteDiv);
            }
        }

        // Initial load
        loadNotes();
    </script>
</body>
</html>
